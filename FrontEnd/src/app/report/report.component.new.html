<div class="reports-container">
  <mat-tab-group dynamicHeight>
    <!-- Summary Report Tab -->
    <mat-tab label="Summary Report">
      <mat-card class="report-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>assessment</mat-icon>
            Summary Report
          </mat-card-title>
        </mat-card-header>
        
        <mat-card-content>
          <form [formGroup]="summaryForm" (ngSubmit)="generateSummaryReport()" class="report-form">
            <div class="form-row">
              <mat-form-field appearance="outline">
                <mat-label>Scenario</mat-label>
                <input matInput formControlName="scenario" placeholder="Enter scenario">
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>Account</mat-label>
                <input matInput formControlName="account" placeholder="Enter account">
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>Department</mat-label>
                <input matInput formControlName="department" placeholder="Enter department">
              </mat-form-field>
            </div>
            
            <div class="form-row">
              <mat-form-field appearance="outline">
                <mat-label>From Date</mat-label>
                <input matInput [matDatepicker]="fromPicker" formControlName="from">
                <mat-datepicker-toggle matSuffix [for]="fromPicker"></mat-datepicker-toggle>
                <mat-datepicker #fromPicker></mat-datepicker>
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>To Date</mat-label>
                <input matInput [matDatepicker]="toPicker" formControlName="to">
                <mat-datepicker-toggle matSuffix [for]="toPicker"></mat-datepicker-toggle>
                <mat-datepicker #toPicker></mat-datepicker>
              </mat-form-field>
              
              <button mat-raised-button color="primary" type="submit" [disabled]="isLoadingSummary()">
                <mat-icon>play_arrow</mat-icon>
                Generate Summary
              </button>
            </div>
          </form>
          
          <mat-progress-bar *ngIf="isLoadingSummary()" mode="indeterminate"></mat-progress-bar>
          
          <div *ngIf="summaryData().length > 0" class="results-section">
            <h3>Summary Results ({{ summaryData().length }} records)</h3>
            <div class="table-container">
              <table mat-table [dataSource]="summaryData()" class="summary-table">
                <ng-container matColumnDef="account">
                  <th mat-header-cell *matHeaderCellDef>Account</th>
                  <td mat-cell *matCellDef="let element">{{ element.account }}</td>
                </ng-container>

                <ng-container matColumnDef="department">
                  <th mat-header-cell *matHeaderCellDef>Department</th>
                  <td mat-cell *matCellDef="let element">{{ element.department }}</td>
                </ng-container>

                <ng-container matColumnDef="scenario">
                  <th mat-header-cell *matHeaderCellDef>Scenario</th>
                  <td mat-cell *matCellDef="let element">{{ element.scenario }}</td>
                </ng-container>

                <ng-container matColumnDef="totalAmount">
                  <th mat-header-cell *matHeaderCellDef>Total Amount</th>
                  <td mat-cell *matCellDef="let element" [class.negative]="element.totalAmount < 0">
                    {{ element.totalAmount | currency }}
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="summaryColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: summaryColumns;"></tr>
              </table>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-tab>

    <!-- Monthly Report Tab -->
    <mat-tab label="Monthly Report">
      <mat-card class="report-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>trending_up</mat-icon>
            Monthly Report
          </mat-card-title>
        </mat-card-header>
        
        <mat-card-content>
          <form [formGroup]="monthlyForm" (ngSubmit)="generateMonthlyReport()" class="report-form">
            <div class="form-row">
              <mat-form-field appearance="outline">
                <mat-label>Account</mat-label>
                <input matInput formControlName="account" placeholder="Enter account">
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>Scenario</mat-label>
                <input matInput formControlName="scenario" placeholder="Enter scenario">
              </mat-form-field>
              
              <button mat-raised-button color="primary" type="submit" [disabled]="isLoadingMonthly()">
                <mat-icon>play_arrow</mat-icon>
                Generate Monthly
              </button>
            </div>
          </form>
          
          <mat-progress-bar *ngIf="isLoadingMonthly()" mode="indeterminate"></mat-progress-bar>
          
          <div *ngIf="monthlyData().length > 0" class="results-section">
            <h3>Monthly Results ({{ monthlyData().length }} records)</h3>
            <div class="table-container">
              <table mat-table [dataSource]="monthlyData()" class="monthly-table">
                <ng-container matColumnDef="month">
                  <th mat-header-cell *matHeaderCellDef>Month</th>
                  <td mat-cell *matCellDef="let element">{{ element.month }}</td>
                </ng-container>

                <ng-container matColumnDef="total">
                  <th mat-header-cell *matHeaderCellDef>Total</th>
                  <td mat-cell *matCellDef="let element" [class.negative]="element.total < 0">
                    {{ element.total | currency }}
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="monthlyColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: monthlyColumns;"></tr>
              </table>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-tab>

    <!-- Drilldown Report Tab -->
    <mat-tab label="Drilldown Report">
      <mat-card class="report-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>zoom_in</mat-icon>
            Drilldown Report
          </mat-card-title>
        </mat-card-header>
        
        <mat-card-content>
          <form [formGroup]="drilldownForm" (ngSubmit)="generateDrilldownReport()" class="report-form">
            <div class="form-row">
              <mat-form-field appearance="outline">
                <mat-label>Scenario *</mat-label>
                <input matInput formControlName="scenario" placeholder="Enter scenario" required>
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>Account *</mat-label>
                <input matInput formControlName="account" placeholder="Enter account" required>
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>Period *</mat-label>
                <input matInput formControlName="period" placeholder="e.g., 2024-01" required>
              </mat-form-field>
            </div>
            
            <div class="form-row">
              <mat-form-field appearance="outline">
                <mat-label>Department</mat-label>
                <input matInput formControlName="department" placeholder="Enter department">
              </mat-form-field>
              
              <button mat-raised-button color="primary" type="submit" [disabled]="isLoadingDrilldown() || !drilldownForm.valid">
                <mat-icon>play_arrow</mat-icon>
                Generate Drilldown
              </button>
            </div>
          </form>
          
          <mat-progress-bar *ngIf="isLoadingDrilldown()" mode="indeterminate"></mat-progress-bar>
          
          <div *ngIf="drilldownData().length > 0" class="results-section">
            <h3>Drilldown Results ({{ drilldownData().length }} records)</h3>
            <div class="table-container">
              <table mat-table [dataSource]="drilldownData()" class="drilldown-table">
                <ng-container matColumnDef="account">
                  <th mat-header-cell *matHeaderCellDef>Account</th>
                  <td mat-cell *matCellDef="let element">{{ element.account }}</td>
                </ng-container>

                <ng-container matColumnDef="period">
                  <th mat-header-cell *matHeaderCellDef>Period</th>
                  <td mat-cell *matCellDef="let element">{{ element.period }}</td>
                </ng-container>

                <ng-container matColumnDef="amount">
                  <th mat-header-cell *matHeaderCellDef>Amount</th>
                  <td mat-cell *matCellDef="let element" [class.negative]="element.amount < 0">
                    {{ element.amount | currency }}
                  </td>
                </ng-container>

                <ng-container matColumnDef="department">
                  <th mat-header-cell *matHeaderCellDef>Department</th>
                  <td mat-cell *matCellDef="let element">{{ element.department }}</td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="drilldownColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: drilldownColumns;"></tr>
              </table>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-tab>

    <!-- Comparison Report Tab -->
    <mat-tab label="Scenario Comparison">
      <mat-card class="report-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>compare_arrows</mat-icon>
            Scenario Comparison
          </mat-card-title>
        </mat-card-header>
        
        <mat-card-content>
          <form [formGroup]="comparisonForm" (ngSubmit)="generateComparisonReport()" class="report-form">
            <div class="form-row">
              <mat-form-field appearance="outline">
                <mat-label>Base Scenario *</mat-label>
                <input matInput formControlName="baseScenario" placeholder="Enter base scenario" required>
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>Target Scenario *</mat-label>
                <input matInput formControlName="targetScenario" placeholder="Enter target scenario" required>
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>Period *</mat-label>
                <input matInput formControlName="period" placeholder="e.g., 2024-01" required>
              </mat-form-field>
            </div>
            
            <div class="form-row">
              <mat-checkbox formControlName="includeDepartment">Include Department Breakdown</mat-checkbox>
              
              <button mat-raised-button color="primary" type="submit" [disabled]="isLoadingComparison() || !comparisonForm.valid">
                <mat-icon>play_arrow</mat-icon>
                Generate Comparison
              </button>
            </div>
          </form>
          
          <mat-progress-bar *ngIf="isLoadingComparison()" mode="indeterminate"></mat-progress-bar>
          
          <div *ngIf="comparisonData().length > 0" class="results-section">
            <h3>Comparison Results ({{ comparisonData().length }} records)</h3>
            <div class="table-container">
              <table mat-table [dataSource]="comparisonData()" class="comparison-table">
                <ng-container matColumnDef="account">
                  <th mat-header-cell *matHeaderCellDef>Account</th>
                  <td mat-cell *matCellDef="let element">{{ element.account }}</td>
                </ng-container>

                <ng-container matColumnDef="department">
                  <th mat-header-cell *matHeaderCellDef>Department</th>
                  <td mat-cell *matCellDef="let element">{{ element.department }}</td>
                </ng-container>

                <ng-container matColumnDef="baseAmount">
                  <th mat-header-cell *matHeaderCellDef>Base Amount</th>
                  <td mat-cell *matCellDef="let element" [class.negative]="element.baseAmount < 0">
                    {{ element.baseAmount | currency }}
                  </td>
                </ng-container>

                <ng-container matColumnDef="targetAmount">
                  <th mat-header-cell *matHeaderCellDef>Target Amount</th>
                  <td mat-cell *matCellDef="let element" [class.negative]="element.targetAmount < 0">
                    {{ element.targetAmount | currency }}
                  </td>
                </ng-container>

                <ng-container matColumnDef="difference">
                  <th mat-header-cell *matHeaderCellDef>Difference</th>
                  <td mat-cell *matCellDef="let element" [class.negative]="element.difference < 0" [class.positive]="element.difference > 0">
                    {{ element.difference | currency }}
                  </td>
                </ng-container>

                <ng-container matColumnDef="percentageChange">
                  <th mat-header-cell *matHeaderCellDef>% Change</th>
                  <td mat-cell *matCellDef="let element" [class.negative]="element.percentageChange < 0" [class.positive]="element.percentageChange > 0">
                    {{ element.percentageChange | number:'1.2-2' }}%
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="comparisonColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: comparisonColumns;"></tr>
              </table>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-tab>
  </mat-tab-group>
</div>
